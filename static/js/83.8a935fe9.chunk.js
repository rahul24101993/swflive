(this.webpackJsonpswflearning=this.webpackJsonpswflearning||[]).push([[83],{3205:function(e,t,n){"use strict";n.r(t),n.d(t,"initializeTable",(function(){return U}));var l=n(7),o=n(1),i=n.n(o),a=n(2918),r=n(6),s=n(122),d=n(2975),c=function(e){var t=!1,n=!1,l=this,o=function(e,t){var n=e.getElementsByClassName(a.a.Const.CLASS_COLUMN_DEF)[0],l=t.getElementsByClassName(a.a.Const.CLASS_COLUMN_DEF)[0];if(n&&n.columnDef&&l&&l.columnDef){var o=n.columnDef.index;return n.columnDef.index=l.columnDef.index,l.columnDef.index=o,!0}return!1},r=function(l){var i,r,s,c=0,u=0;l.classList.add(a.a.Const.CLASS_HEADER_DRAGGABLE);var f=l.getElementsByClassName(a.a.Const.CLASS_COLUMN_DEF)[0],m=l.getElementsByClassName(a.a.Const.CLASS_CELL_CONTENTS)[0];d.a.enableDragging(m),m.addEventListener(a.a.Const.EVENT_ON_ELEM_DRAG_START,(function(t){a.a.util.getTableMenuService(e).ensureAllTableMenusDismissed();var n=t?t.detail:window.event;(i=l.cloneNode(!0)).classList.add(a.a.Const.CLASS_UTILITY_HIDDEN),i.setAttribute("id",i.id+"ClonedHeader");var o=a.a.util.closestElement(l,"."+a.a.Const.CLASS_PIN_CONTAINER+",."+a.a.Const.CLASS_SCROLL_CONTAINER),d=o.getElementsByClassName(a.a.Const.CLASS_VIEWPORT)[0].scrollLeft;o.appendChild(i),i.style.left=l.offsetLeft-d+"px",i.style.top=l.offsetTop+"px",u=n.clientX,f&&f.columnDef&&(r=f.columnDef,s=r.index)})),m.addEventListener(a.a.Const.EVENT_ON_ELEM_DRAG,(function(e){var r=e?e.detail:window.event;t||(l.classList.add("stationaryHeader"),i.classList.add("dragHeader"),i.classList.remove(a.a.Const.CLASS_UTILITY_HIDDEN),t=!0),c=u-r.clientX,u=r.clientX,i.style.left=i.offsetLeft-c+"px",n=function(e,t){var n=e.getBoundingClientRect(),l=e.nextSibling,i=e.previousSibling;return l&&t>n.right+l.getBoundingClientRect().width/3&&l.classList.contains(a.a.Const.CLASS_HEADER_DRAGGABLE)&&o(l,e)?(e.parentNode.insertBefore(l,e),!0):!!(i&&t<n.left-i.getBoundingClientRect().width/2&&i.classList.contains(a.a.Const.CLASS_HEADER_DRAGGABLE)&&o(i,e))&&(e.parentNode.insertBefore(e,i),!0)}(l,r.clientX)||n})),m.addEventListener(a.a.Const.EVENT_ON_ELEM_DRAG_END,(function(){if(l.classList.remove("stationaryHeader"),i.parentNode.removeChild(i),t=!1,n){n=!1;var o={name:r.name,originalPosition:s};e._tableInstance.tableInstanceCallbacks.columnsRearranged(o),function(t,n){if(t!==n.index)for(var l=t<n.index?-1:1,o=a.a.util.getColumnContentCellElementsByIndex(e,n.index+l),i=a.a.util.getColumnContentCellElementsByIndex(e,n.index),r=0;r<i.length;r++){var s=i[r],d=o[r];t<n.index&&(d=d.nextSibling),s.parentNode.insertBefore(s,d)}}(s,r)}}))};return l.initialize=function(){var t=e.getElementsByClassName(a.a.Const.CLASS_HEADER_CELL);i.a.forEach(t,(function(e){var t,n=e.getElementsByClassName(a.a.Const.CLASS_COLUMN_DEF);n.length>0&&(t=n[0].columnDef),t&&!1!==t.enableColumnMoving&&r(e)}))},l.initialize(),l},u=n(26),f=function(){var e,t,n,l,o,i,a,r,s=null,d=null,c=0,u=0,f=function(e){return e.touches[0].pageY},m=function(e){return e.touches[0].pageX},p=function(){d.scrollTop-u>=0&&(d.scrollTop-=u),d.scrollLeft-c>=0&&(d.scrollLeft-=c)},g=function(){var e=Date.now(),t=e-o;o=e;var i=1e3*u/(1+t),a=1e3*c/(1+t);u=0,c=0,l=Math.round(.4*i+.2*l),n=Math.round(.4*a+.2*n)},b=function(){if(r||a){var e=Date.now()-o;u=-r*Math.exp(-e/325),c=-a*Math.exp(-e/325),u>.5||u<-.5||c>.5||c<-.5?(p(),requestAnimationFrame(b)):p()}},h=function(s){e=f(s),t=m(s),l=0,n=0,r=0,a=0,o=Date.now(),clearInterval(i),i=setInterval(g,50)},C=function(n){if(d.scrollTop-(e-f(n))<=0||d.scrollLeft-(t-m(n))<=0)n.preventDefault(),n.stopPropagation();else{var l=f(n);u=e-l,e=l;var o=m(n);c=t-o,t=o}},E=function(){clearInterval(i),(l>10||l<-10||n>10||n<-10)&&(r=.6*l,a=.6*n,o=Date.now(),requestAnimationFrame(b))};this.enable=function(e,t){null!==e&&((s=e).addEventListener("touchstart",h,{passive:!0}),s.addEventListener("touchmove",C,{passive:!0}),s.addEventListener("touchend",E,{passive:!0})),null!==t&&((d=t).addEventListener("touchstart",h,{passive:!0}),d.addEventListener("touchmove",C,{passive:!0}),d.addEventListener("touchend",E,{passive:!0}))},this.disable=function(){null!==s&&(s.removeEventListener("touchstart",h),s.removeEventListener("touchmove",C),s.removeEventListener("touchend",E),s=null),null!==d&&(d.removeEventListener("touchstart",h),d.removeEventListener("touchmove",C),d.removeEventListener("touchend",E),d=null)}};var m=function(e){let t=this,n={},l=0,o=0,s=[],d=[],c=!1,m=!1,p=e,g=p-n.headerHeight,b=0,h=14,C=0,E=0,v=!1,w=null,S=!1,T=!1,x=0,I=0,R=u.default.isIE||u.default.isFirefox?200:0,L=u.default.isIE?500:0,A=u.default.isIE||u.default.isFirefox?1/0:0,y=new f,_=new Date,M=0,N=0,D=i.a.debounce((function(){n.scrollViewportElem&&n.scrollViewportElem.offsetWidth&&(I=n.scrollViewportElem.offsetWidth),n.updateScrollColumnsInView(E,I),n.updateVisibleCells(n.scrollParentElem)}),L),H=i.a.debounce((function(){!function(){let e;e=l>o?t.handleScrollDown:K;o=l,l>0?n.tableElem.classList.contains(a.a.Const.CLASS_TABLE_SCROLLED)||n.tableElem.classList.add(a.a.Const.CLASS_TABLE_SCROLLED):n.tableElem.classList.contains(a.a.Const.CLASS_TABLE_SCROLLED)&&n.tableElem.classList.remove(a.a.Const.CLASS_TABLE_SCROLLED);e.call()}()}),R,{maxWait:A});t.initializeGrid=function(e){n=e,n.pinParentElem=n.pinViewportElem.children[0],n.scrollParentElem=n.scrollViewportElem.children[0],n.totalFound=n.loadedVMObjects.length,n.dynamicRowHeightStatus=n.dynamicRowHeightStatus||!1,n.scrollViewportElem.removeEventListener("scroll",W),n.scrollViewportElem.removeEventListener("scroll",z),n.pinViewportElem.removeEventListener("scroll",q),n.scrollViewportElem.addEventListener("scroll",W),n.scrollViewportElem.addEventListener("scroll",z),n.pinViewportElem.addEventListener("scroll",q),y.enable(n.pinViewportElem,n.scrollViewportElem),c=!0};let V,O=function(){return p-n.headerHeight};function P(e){C=e,function(e){h=Math.max(10,Math.min(30,e))}(e)}function F(e){return d[e]?e===d.length-1?d[e]:d[e]-1:n.rowHeight}function B(e){let t=0;for(let n=0;n<e;n++)t+=F(n);return t}function j(e){let t=0,n=0;for(;t<e;)t+=F(n),n++;return n}function k(){return j(l+g)-1}function z(){V&&clearTimeout(V),V=setTimeout((function(){!function(){const e=n.scrollParentElem;if(s=e.querySelectorAll(n.rowSelector),0===s.length)r.a.error("Rendering error");else{let e,t,o;const i=s[0],a=parseInt(i.getAttribute("data-indexNumber"));o=n.treeTableEditSettings?(a-n.treeTableEditSettings.firstIndex)*n.rowHeight-l:B(a)-l,o<0&&(t=Math.abs(j(l)-a),e=t-h,e>0&&X(e,0));const r=s[s.length-1],d=parseInt(r.getAttribute("data-indexNumber")),c=C*n.rowHeight+l,u=k();o=n.treeTableEditSettings?(d-n.treeTableEditSettings.firstIndex)*n.rowHeight+n.rowHeight-c:d-u,o>0&&(t=d-u,e=t-h,e>0&&X(s.length-1,s.length-e-1))}t.updateRowAlignment()}()}),300)}function G(e){n.pinViewportElem.style.top=String(-1*e)+"px",N=e}function U(){n.pinViewportElem.style.top="0px",N=0}function W(e){_=new Date;let t=l;l=n.scrollViewportElem.scrollTop;let o=E;E=n.scrollViewportElem.scrollLeft,t===l&&l<0&&o===E&&E<0&&(e.preventDefault(),e.stopPropagation());let i=n.pinViewportElem;if(0!==x||t===l&&0!==l||(T=!0,i.scrollTop=l),n.onStartScroll(),o!==E&&E>=0&&(n.syncHeader(!1,E),D()),t!==l&&l>=0){let e=i.offsetHeight+l-i.scrollHeight;e>0?n.scrollViewportElem.clientWidth>0&&G(e):N>0&&U(),H()}x-=1,x<0&&(x=0)}function q(e){if(!0!==T){var t=n.pinViewportElem.scrollLeft;n.syncHeader(!0,t),n.pinViewportElem.scrollTop!==l&&(x+=1,n.pinViewportElem.scrollTop!==n.pinViewportElem.scrollHeight-n.pinViewportElem.offsetHeight?n.scrollViewportElem.scrollTop=n.pinViewportElem.scrollTop:n.scrollViewportElem.scrollTop=n.pinViewportElem.scrollTop+40,e.preventDefault())}else T=!1}function K(){if(s&&s.length){var e,o=s[0],i=parseInt(o.getAttribute("data-indexNumber"));e=n.treeTableEditSettings?(i-n.treeTableEditSettings.firstIndex)*n.rowHeight:B(i);var a=j(l);if(!0===e>l+g)t.handleScroll();else if(e>B(a-h)){var r=i-a,d=i-1;J(d-h-(r=r<0?0:r),d)}}else t.handleScroll()}function X(e,t){n.removeRows(e,t),s=n.scrollParentElem.querySelectorAll(n.rowSelector)}function Y(e,t){if(n.renderRows(e,t),s=n.scrollParentElem.querySelectorAll(n.rowSelector),n.dynamicRowHeightStatus){let e=d.length-1,t=s[0].getAttribute("data-indexnumber"),n=s[s.length-1].getAttribute("data-indexnumber");(e<t||e>n)&&(d[d.length-1]=null);for(let l of s){let e=parseInt(l.getAttribute("data-indexnumber"));d[e]=l.offsetHeight}}}function J(e,l,o){var i;n.treeTableEditSettings?(e<n.treeTableEditSettings.firstIndex&&(e=n.treeTableEditSettings.firstIndex),l>n.treeTableEditSettings.lastIndex&&(l=n.treeTableEditSettings.lastIndex),i=n.treeTableEditSettings.totalDataLength):(e<0&&(e=0),i=n.totalFound),e>=i&&(0===i?(X(s.length-1,0),t.updateRowAlignment()):(n.updateScrollColumnsInView(E,I),Y(e,l)),e===i)?r.a.trace("Table scroll service: Rendering of page data complete. No more data to render."):(e>i&&(l-=e,e=0),l>=i&&(l=i-1),o&&X(s.length-1,0),Y(e,l),t.updateRowAlignment(),function(){var e=0,t=0,l=s[0];e=parseInt(l.getAttribute("data-indexNumber"));var o=s[s.length-1];t=parseInt(o.getAttribute("data-indexNumber"));var i={index:e,uid:l.vmo.uid,levelNdx:l.vmo.levelNdx},a={index:t,uid:o.vmo.uid,levelNdx:o.vmo.levelNdx};n.afterGridRenderCallback(i,a)}())}t.checkForResize=i.a.debounce((async function(){if(M=new Date-_,M<200)return;let e=n.scrollViewportElem.offsetWidth;if(e!==I&&(e>I?(I=e,n.updateScrollColumnsInView(E)):(I=e,n.updateScrollColumnsInView(E,I)),n.updateVisibleCells(n.scrollParentElem),t.handlePinViewportScrollbarPadding()),n.directiveElem.clientHeight!==p){p=n.directiveElem.clientHeight;let e=n.scrollViewportElem.clientHeight||n.pinViewportElem.clientHeight||p,l=Math.floor(e/n.rowHeight);g=O(),P(l),await t.handleScroll()}}),200),t.isInitialized=function(){return c},t.renderInitialRows=function(){t.initializeProperties(),n.initialRowIndex=b,t.handleScroll()},t.getFirstRenderedItemIndex=function(){var e=s[0];return parseInt(e.getAttribute("data-indexNumber"))},t.getLastRenderedItemIndex=function(){var e=s[s.length-1];return parseInt(e.getAttribute("data-indexNumber"))},t.setContainerHeight=function(e){p=e,g=O(),n.scrollViewportElem.style.maxHeight=String(g)+"px",n.pinViewportElem.style.maxHeight=String(g)+"px"},t.setDynamicRowHeight=function(e){n.dynamicRowHeightStatus=e,n.tableElem._tableInstance&&(n.tableElem._tableInstance.dynamicRowHeightStatus=e)},t.initializeProperties=function(){d=[],void 0===p?(p=e>0?e:n.directiveElem.clientHeight,g=O()):!1===m&&t.setContainerHeight(p),m=!0,n.scrollViewportElem.style.minHeight=String(n.rowHeight)+"px",n.pinViewportElem.style.minHeight=String(n.rowHeight)+"px";let l=g;l<0&&(l=0),P(Math.floor(l/n.rowHeight)),r.a.trace("Table scroll service: Visible row count - "+C)},t.updateRowAlignment=function(){let e,t=0;if(s){let e=s[0];if(e&&e.getAttribute("data-indexNumber")){let l=parseInt(e.getAttribute("data-indexNumber"));t=n.treeTableEditSettings?(l-n.treeTableEditSettings.firstIndex)*n.rowHeight:B(l)}}n.pinParentElem.style.top=t+"px",n.scrollParentElem.style.top=t+"px",e=n.treeTableEditSettings?(n.treeTableEditSettings.lastIndex-n.treeTableEditSettings.firstIndex+1)*n.rowHeight-t:B(n.totalFound)-t,n.pinParentElem.style.height=e+"px",n.scrollParentElem.style.height=e+"px"},t.getRowHeight=function(){return n.rowHeight},t.manualScroll=function(e){let l=e?t.getRowHeight():-t.getRowHeight();return n.scrollViewportElem.scrollTop+=l,n.scrollViewportElem.scrollTop},t.getScrollTop=function(){return n.scrollViewportElem.scrollTop},t.setRowHeight=function(e){n.rowHeight=e},t.getTotalFound=function(){return n.totalFound},t.setLoadedVMObjects=function(e){!0===S&&function(e){S=!1,v=!0;let t=j(n.scrollViewportElem.scrollTop);w=B(t+e)}(e.length-n.totalFound),n.loadedVMObjects=e,n.totalFound=e.length},t.setScrollPositionToBeMaintained=function(){S=!0},t.isScrollToRowInProgress=function(){return v},t.handlePinViewportScrollbarPadding=function(){const e=n.pinViewportElem,t=n.scrollViewportElem;if(l>=0)if("0px"===e.style.top&&t.clientWidth>0){let t=e.offsetHeight+l-e.scrollHeight;t>0&&G(t)}else"0px"!==e.style.top&&t.clientWidth<=0&&U()},t.handleScrollDown=function(){if(s&&s.length){let e,o=s[s.length-1],i=parseInt(o.getAttribute("data-indexNumber"));e=n.treeTableEditSettings?(i-n.treeTableEditSettings.firstIndex)*n.rowHeight+n.rowHeight:B(i+1);let a=k();if(!0===e<l)i+1<n.totalFound&&t.handleScroll();else if(e<B(a+h)){let e=a-i;e=e<0?0:e;let t=i+1;J(t,t+h+e)}}else t.handleScroll()},t.handleScroll=function(){var e;if(n.initialRowIndex){t.updateRowAlignment();var i=j(B(n.initialRowIndex)-.75*g),a=B(i);delete n.initialRowIndex,l=a<0?0:a,e=i,n.scrollViewportElem.scrollTop=l}!0===v&&(t.updateRowAlignment(),n.scrollViewportElem.scrollTop=w,v=!1,w=null),e||(e=j(l));var r=e-h,s=e+C+h;if(s>n.totalFound-1){var d=s-n.totalFound-1;s-=d,r-=d}J(r,s,!0),o=l},t.setupTreeEditScroll=function(e){if(e){if(s&&s[0]){for(var l=s[0],o=parseInt(l.getAttribute("data-indexNumber")),i=n.loadedVMObjects[o].props;i&&o>0;)(i=n.loadedVMObjects[o-1].props)&&o--;var a=s[s.length-1],r=parseInt(a.getAttribute("data-indexNumber"));for(i=n.loadedVMObjects[r].props;i&&r<n.totalFound-1;)(i=n.loadedVMObjects[r+1].props)&&r++;n.treeTableEditSettings={firstIndex:o,lastIndex:r,totalDataLength:r+1},t.updateRowAlignment()}}else if(n.treeTableEditSettings){var d=(n.scrollViewportElem.scrollTop/t.getRowHeight()+n.treeTableEditSettings.firstIndex-1)*t.getRowHeight();delete n.treeTableEditSettings,t.updateRowAlignment(),t.handleScroll(),n.pinViewportElem.scrollTop=d,n.scrollViewportElem.scrollTop=d}},t.resetInfiniteScroll=function(){t.setLoadedVMObjects([]),t.resetInitialRowIndex(),d=[],n.scrollViewportElem.scrollTop=0,n.pinViewportElem.style.top="0px",n.scrollViewportElem.style.top="0px",l=0,t.handleScroll()},t.resetRowHeightCache=function(){d=[]},t.destroyGrid=function(){n.scrollViewportElem&&n.scrollViewportElem.removeEventListener("scroll",W),n.scrollViewportElem&&n.scrollViewportElem.removeEventListener("scroll",z),n.pinViewportElem&&n.pinViewportElem.removeEventListener("scroll",q),y.disable(),t.checkForResize.cancel(),D.cancel(),H.cancel()},t.scrollToRowIndex=function(e){if(!0===t.isInitialized()){var l=null,o=0,i=0;s.length>0&&(o=Number(s[0].getAttribute("data-indexnumber")),i=Number(s[s.length-1].getAttribute("data-indexnumber")));for(var a=n.scrollViewportElem.getBoundingClientRect(),r=0;r<e.length;r++){var d=e[r];if(s.length>0){if(d>i||d<o){b=d;continue}if((l=s[d-o].getBoundingClientRect()).top<a.top||l.bottom>a.bottom){b=d;continue}b=d}return!1}var c=n.scrollViewportElem.scrollHeight-n.scrollViewportElem.clientHeight,u=Math.floor(B(b)-.75*g),f=b-o;s[f]&&((l=s[f].getBoundingClientRect()).top<a.top&&l.bottom>a.top?u=B(b):l.top<a.bottom&&l.bottom>a.bottom&&(u=n.scrollViewportElem.scrollTop+(l.bottom-a.bottom))),u>c&&(v=!0,w=u),n.scrollViewportElem.scrollTop=u}else b=e[0];return!0},t.scrollToColumn=function(e){(e.startPosition<=E||e.startPosition>E+I)&&(n.scrollViewportElem.scrollLeft=e.startPosition-10)},t.isInitialRowIndexInView=function(){let e=Number(s[0].getAttribute("data-indexnumber")),t=s[b-e];if(void 0===t)return!1;let n=t.getAttribute("data-indexnumber"),o=j(l),i=k();return!(n<o||b>i)},t.resetInitialRowIndex=function(){b=0}},p=n(12),g=n(65),b=n(2949),h=n(27);var C=function(e,t){let n=this,l=e,o=t,i=a.a.util.getTableInstance(l),r=new a.a.Trv(e);const s="data-indexNumber",d=function(e){e.preventDefault(),e.stopPropagation()},c=function(e){switch(e){case"Up":case"ArrowUp":return"UP";case"Down":case"ArrowDown":return"DOWN";case"Left":case"ArrowLeft":return"LEFT";case"Right":case"ArrowRight":return"RIGHT";default:return null}},u=function(e){e.target.tabIndex="0"},f=function(e){e.target.tabIndex="-1"};n.setOnFocusAndBlur=function(e){e.addEventListener("focus",u),e.addEventListener("blur",f)};const m=function(e){return e.classList.contains(a.a.Const.CLASS_HEADER_CELL)},C=function(e){return e.classList.contains(a.a.Const.CLASS_CELL)},E=function(e){return e.classList.contains(a.a.Const.CLASS_TABLE_CONTAINER)},v=function(e){return a.a.util.closestElement(e,".".concat(a.a.Const.CLASS_TABLE_MENU_BUTTON))},w=function(){l.querySelector(".".concat(a.a.Const.CLASS_TABLE_MENU_BUTTON," button")).focus()},S=function(){let e;return i.gridOptions.transpose?e=i.controller.getColumnDefs():(e=i.dataProvider.cols,e=e.filter((function(e){return!0!==e.hiddenFlag}))),e},T=(e,t,n,l,o)=>{let i={newRowIdx:null,newColIdx:null,scrollLeft:null};if(!e)return i.newColIdx=1,i.newRowIdx=1,i;if(v(e))return"LEFT"===t?(i.newColIdx=n.length,i.newRowIdx=1):"DOWN"===t&&(i.newRowIdx=2,i.newColIdx=n.length,i.scrollLeft=n[n.length-1].startPosition),i;const r=parseInt(e.getAttribute("aria-colindex"));switch(t){case"UP":if(l<=1)return null;i.newColIdx=r,i.newRowIdx=l-1;break;case"DOWN":if(l>=o)return null;i.newColIdx=r,i.newRowIdx=l+1;break;case"LEFT":if(r<=1)return null;i.newColIdx=r-1,i.newRowIdx=l;break;case"RIGHT":if(r>=n.length)return m(e)&&w(),null;i.newColIdx=r+1,i.newRowIdx=l}return i.newColIdx!==r&&(i.scrollLeft=function(e,t,n,l){const o=S();let i=e.columnDef||e.getElementsByClassName(a.a.Const.CLASS_COLUMN_DEF)[0].columnDef,r=o.indexOf(i),s=null,d=o[r+(l-n)];return i&&d&&i.pinnedLeft&&!d.pinnedLeft?s=0:1===t&&d&&!d.pinnedLeft&&(s=d.startPosition),s}(e,l,r,i.newColIdx)),i},x=(e,t)=>{const n=S();let o;o=i.gridOptions.transpose?i.dataProvider.cols.length+1:i.dataProvider.viewModelCollection.getLoadedViewModelObjects().length+1;const s=e?parseInt(e.parentElement.getAttribute("aria-rowindex")):null,d=T(e,t,n,s,o);if(!d)return;const c=d.newRowIdx,u=d.newColIdx,f=d.scrollLeft;let m=r.getScrollContainerElementFromTable().getElementsByClassName(a.a.Const.CLASS_VIEWPORT)[0];1===s&&2===c&&(m.scrollTop=0),null!==f&&(m.scrollLeft=f),setTimeout((function(){let e="[aria-rowindex='".concat(c,"'] [aria-colindex='").concat(u,"']"),t=l.querySelector(e);t&&t.focus()}),100)},I=function(e,t){const n=S();if(m(e))if(t)x();else{const e=n[n.length-1],t=e.startPosition;if(!e.pinnedLeft){r.getScrollContainerElementFromTable().getElementsByClassName(a.a.Const.CLASS_VIEWPORT)[0].scrollLeft=t}setTimeout((function(){let e="[aria-rowindex='1'] [aria-colindex='".concat(n.length,"']"),t=l.querySelector(e);t&&t.focus()}),50)}else if(C(e)||a.a.util.closestElement(e,".".concat(a.a.Const.CLASS_CELL))){let o,i=a.a.util.closestElement(e,".".concat(a.a.Const.CLASS_CELL));const d=i?i.parentElement.getAttribute(s):e.parentElement.getAttribute(s);if(t){if(o=n[0],!o.pinnedLeft){r.getScrollContainerElementFromTable().getElementsByClassName(a.a.Const.CLASS_VIEWPORT)[0].scrollLeft=0}}else if(o=n[n.length-1],!o.pinnedLeft){r.getScrollContainerElementFromTable().getElementsByClassName(a.a.Const.CLASS_VIEWPORT)[0].scrollLeft=o.startPosition}setTimeout((function(){let e="[aria-rowindex='".concat(parseInt(d)+2,"'] [aria-colindex='").concat(o.index+1,"']"),t=l.querySelector(e);t&&t.focus()}),50)}},R=function(e,t){let n=e.parentElement&&e.parentElement.vmo;o.onClickHandler(t,e,n);b.default.selectionChanged(l,e)(t)};n.setupInternalCellNavigation=e=>{e.onkeydown=function(t){const n=c(t.key);let r=(s=e,h.default.findFocusableChildren(s).length>0);var s;!a.a.util.isBulkEditing(l)&&!e.isElementInEdit&&r&&("LEFT"===n||"RIGHT"===n?(delete i.focusTreeNodeExpandAfterRender,((e,t,n)=>{if(d(n),document.activeElement===e&&"RIGHT"===t){o.removeAllCellSelection();let t=h.default.findNextFocusableChild(e,!0);t&&t.focus()}else if("RIGHT"===t){let n=h.default.findNextFocusableChild(e);n?n.focus():x(e,t)}else{let n=h.default.findPreviousFocusableChild(e);n?n.focus():x(e,t)}})(e,n,t)):"DOWN"!==n&&"UP"!==n||document.activeElement===e||(delete i.focusTreeNodeExpandAfterRender,d(t),x(e,n)))}};const L=e=>{if(a.a.util.isCellEditing(l)&&!e.isElementInEdit){const e=i.dataProvider.json&&i.dataProvider.json.editContext?i.dataProvider.json.editContext:i.declViewModel._internal.editContext?i.declViewModel._internal.editContext:null;let t=null;if(e&&(t=g.a.getEditHandler(e)),t)t.cancelEdits();else if(i.dataProvider.getEditConfiguration()){const e={data:i.declViewModel,ctx:p.default.ctx};i.dataProvider.cancelEdits(e,i.declViewModel)}else i.declViewModel.getEditConfiguration()&&i.declViewModel.cancelEdits()}};n.setupKeyListener=()=>{l.onkeydown=e=>{let t=e.srcElement;if("INPUT"!==t.tagName&&"TEXTAREA"!==t.tagName||(t=a.a.util.closestElement(t,".".concat(a.a.Const.CLASS_CELL))||t),a.a.util.isBulkEditing(l)){if(E(t)){d(e);let n=t.getElementsByClassName("aw-jswidgets-editableGridCell")[0];n&&n.parentElement.focus()}return}const n=e.key,r=c(n);"Tab"===n?((e,t)=>{m(e)&&!t.shiftKey?(d(t),w()):v(e)&&t.shiftKey?(d(t),x()):(E(e)||document.activeElement.closest(a.a.Const.CLASS_TABLE_CONTAINER))&&o.removeAllCellSelection()})(t,e):r?((e,t,n)=>{if(C(e)&&n.shiftKey&&("DOWN"===t||"UP"===t)){d(n),o.removeAllCellSelection();const l=parseInt(e.parentElement.getAttribute(s)),a=i.dataProvider.viewModelCollection.getLoadedViewModelObjects().length;("DOWN"===t&&l<a-1||"UP"===t&&l>0)&&(x(e,t),setTimeout((function(){R(document.activeElement,n)}),100))}else e.isElementInEdit||(d(n),m(e)||C(e)?(o.removeAllCellSelection(),x(e,t)):v(e)?x(e,t):E(e)&&(o.removeAllCellSelection(),x()))})(t,r,e):"Enter"===n||"Space"===n||" "===n?((e,t)=>{C(e)&&!e.isElementInEdit&&(d(t),R(e,t))})(t,e):"Escape"===n||"Esc"===n?L(t):"Home"!==n||t.isElementInEdit?"End"!==n||t.isElementInEdit||(I(t,!1),o.removeAllCellSelection()):(I(t,!0),o.removeAllCellSelection())}}};const E=function(e){let t;t=e.displayName?e.displayName:e.props.object_string?e.props.object_string.uiValues[0]:e.props.object_name?e.props.object_name.uiValues[0]:"";let n={field:e.uid,name:e.uid,displayName:t,enableColumnMoving:!0,enableColumnResizing:!0,enablePinning:!1,width:300,vmo:e,enableRendererContribution:!0,headerTooltip:!0,modifiable:!1};if(e.column){let t=Object.assign(e.column,n);return t.width=t.drawnWidth,t}return n};var v=function(e,t){let n=t;if(!function(e,t){if(e&&e.length===t.length+1){for(let n=0;n<t.length;n++){let l=!1,o=t[n];for(let t=0;t<e.length;t++){let n=e[t];o.uid===n.field&&(l=!0)}if(!1===l)return!0}return!1}return!0}(e,t)){n=[],e=i.a.sortBy(e,"index");for(let l=1;l<e.length;l++){let o=e[l].field;for(let i=0;i<t.length;i++){let a=t[i];if(a.uid===o){a.column=e[l],n.push(a);break}}}}return[{name:"",field:"transposedColumnProperty",displayName:"",pinnedLeft:!0,enableColumnMenu:!1,enableColumnMoving:!1,enableSorting:!1,enableColumnResizing:!0,enableRendererContribution:!0,modifiable:!1,width:125}].concat(n.map(E))},w=function(e,t){for(let o=0;o<e.length;o++)e[o].visible=!e[o].hasOwnProperty("visible")||e[o].visible;let n=i.a.filter(e,(function(e){return!!e.visible&&e})),l=[];for(let o=0;o<n.length;o++){let e=n[o],i={props:{transposedColumnProperty:{uiValue:e.displayName,dbValue:e.field}}};"icon"===e.name&&(i.name="icon");for(let n=0;n<t.length;n++){let l=t[n];"icon"===e.name?i.props[l.uid]={thumbnailURL:l.thumbnailURL,typeIconURL:l.typeIconURL,iconURL:l.iconURL}:i.props[l.uid]=l.props[e.field]}l.push(i)}return l},S=n(271),T=n(3029),x=n(166),I=n(21),R=n(628),L=n(15),A=n(175),y=n(58),_=n(46),M=n(956),N=n(955),D=n(954),H={},V={isIdOfObject:function(e,t){let n=!1;return e&&(e.alternateID&&(n=e.alternateID===t),!n&&e.uid&&(n=e.uid===t||-1!==e.uid.indexOf(t))),n}};const O=I.b.DOMAPIs;H.arrangeMenu=L.default.getLoadedTextFromKey("treeTableMessages.arrangeMenu"),H.removeAllFilters=L.default.getLoadedTextFromKey("treeTableMessages.removeAllFilters"),H.TwistieTooltipExpanded=L.default.getLoadedTextFromKey("treeTableMessages.TwistieTooltipExpanded"),H.TwistieTooltipCollapsed=L.default.getLoadedTextFromKey("treeTableMessages.TwistieTooltipCollapsed"),H.hideColumn=L.default.getLoadedTextFromKey("treeTableMessages.hideColumn"),H.sortAscending=L.default.getLoadedTextFromKey("treeTableMessages.sortAscending"),H.sortDescending=L.default.getLoadedTextFromKey("treeTableMessages.sortDescending"),H.removeSort=L.default.getLoadedTextFromKey("treeTableMessages.removeSort"),H.freezeMenu=L.default.getLoadedTextFromKey("treeTableMessages.freezeMenu"),H.unfreezeMenu=L.default.getLoadedTextFromKey("treeTableMessages.unfreezeMenu"),H.visibilityControlsTitle=L.default.getLoadedTextFromKey("treeTableMessages.visibilityControlsTitle"),H.gridMenu=L.default.getLoadedTextFromKey("treeTableMessages.gridMenu");var P={createTableObject:function(e,t,n,o,r,s,u,f,g,b,h,E,I,P,F){var B=null,j=u||V,k=T.a.createCellRenderer(),z=a.a.util.createElement("div"),G=new a.a.Trv(z),U=null,W=null,q=null,K=!1;let X=null,Y=null,J=null,Q=null,Z=F;var $="compact"===p.default.ctx.layout?a.a.Const.HEIGHT_COMPACT_ROW:a.a.Const.HEIGHT_ROW;$=a.a.util.getTableRowHeight(f,$);var ee=a.a.Const.HEIGHT_HEADER;ee=a.a.util.getTableHeaderHeight(f,ee);let te=function(){let e=n.cols;!0===f.transpose&&(e=v(B,n.viewModelCollection.loadedVMObjects));for(let t=0;t<e.length;t++)e[t].visible=!e[t].hasOwnProperty("visible")||e[t].visible;B=i.a.filter(e,(function(e){return!!e.visible&&e})),i.a.forEach(B,(function(e,t){e.index=t,e.cellRenderers||(e.cellRenderers=[]),"icon"===e.name&&e.iconCellRenderer&&(e.cellRenderers=e.cellRenderers.concat(e.iconCellRenderer)),e.cellRenderers=e.cellRenderers.concat(k.getAwCellRenderers())})),i.a.forEach(B,(function(e,t){e.index=t,e.headerRenderers||(e.headerRenderers=[]),e.headerRenderers=e.headerRenderers.concat(k.getAwHeaderRenderers())})),q.loadDefaultColumnMenus()},ne=function(){return n.viewModelCollection?!0===f.transpose?w(n.cols,n.viewModelCollection.loadedVMObjects):n.viewModelCollection.loadedVMObjects:[]},le=function(){te(),S.default.removeStaleFilters(r,B),U.resetColumnDefs(B),Y.initialize(),X.isInitialized()&&(k.resetHoverCommandElement(),X.setLoadedVMObjects(ne()),X.handleScroll())};var oe=function(e,t){for(var l=[],o=e;o<=t;o++){var i=n.viewModelCollection.loadedVMObjects[o];if(!i.isPropLoading)i.props?0===Object.keys(i.props).length&&l.push(i):l.push(i)}return l};if(t){var ie=[];z.id=t,z.classList.add(a.a.Const.CLASS_TABLE),z.classList.add(a.a.Const.CLASS_WIDGET_GRID),z.classList.add(a.a.Const.CLASS_LAYOUT_COLUMN),z.classList.add(a.a.Const.CLASS_WIDGET_TABLE_DROP),z.classList.add(a.a.Const.CLASS_SELECTION_ENABLED),a.a.util.setSortCriteriaOnColumns(r,n);var ae=function(){return void 0!==g?g:void 0!==f.maxRowsToShow?($+1)*f.maxRowsToShow+a.a.Const.HEIGHT_HEADER:void 0};X=new m(ae()),z._tableInstance={ctx:p.default.ctx,messages:H,declViewModel:s,dataProvider:n,viewModelCollection:o,columnProvider:r,gridId:t,gridOptions:f,isBulkEditing:!1,isCellEditing:!1,renderer:X,dynamicRowHeightStatus:!1,cellRenderer:k,runActionWithViewModel:h,tableInstanceCallbacks:E,tableContext:I||{},showCheckBox:F},W=new a.a.Editor(z,e,b),z._tableInstance.editor=W,J=new C(z,W),J.setupKeyListener(),z._tableInstance.keyboardService=J,q=new a.a.MenuService(z,e,z._tableInstance,b),f.enableGridMenu&&q.addGridMenu(),!0===f.showContextMenu&&q.setContextSelectionHelper(A.a),f.enableDynamicRowHeight&&(z._tableInstance.dynamicRowHeightStatus=!0),te(),U=new a.a.Ctrl(z,B,W,b),z._tableInstance.controller=U,z._tableInstance.editor=W;var re=i.a.debounce((function(e,n){l.a.publish(t+".plTable.loadMorePages",{firstRenderedItem:e,lastRenderedItem:n})}),500),se={},de=i.a.debounce((function(){z._tableInstance.isDestroyed||(!function(e){var t=G.queryAllRowCellElementsFromTable();i.a.forEach(e,(function(e,l){i.a.forEach(t,(function(t){i.a.forEach(t.children,(function(o){let i=null;if(t.vmo&&t.vmo.uid===l)i=t.vmo;else{if(!0!==f.transpose||!o.columnDef.vmo||o.columnDef.vmo.uid!==l)return;i=o.columnDef.vmo}var r=!1;if(o.columnDef&&"icon"===o.columnDef.name||!0===f.transpose&&"icon"===t.vmo.props.transposedColumnProperty.dbValue){var s=o.getElementsByTagName("img")[0];s&&s.getAttribute("src")!==a.a.util.getImgURL(i)&&(r=!0)}else for(var d=0;d<e.length;d++)if(o.propName===e[d]||!0===f.transpose&&t.vmo.props.transposedColumnProperty.dbValue===e[d]){r=!0;break}if(r&&(a.a.Cell.updateCell(o,t,z,W),t.vmo.selected&&(o.columnDef.isTableCommand||o.columnDef.isTreeNavigation))){let e=o.children[0];if(o.columnDef.isTreeNavigation&&(e=o.getElementsByClassName("aw-jswidgets-tableNonEditContainer")[0]),0===e.getElementsByClassName(a.a.Const.CLASS_AW_CELL_COMMANDS_CONTAINER).length&&n.selectionModel&&!n.selectionModel.multiSelectEnabled&&1===n.selectionModel.getCurrentSelectedCount()){let n=T.a.createCellCommandElement(o.columnDef,t.vmo,!0);e.appendChild(n)}}}))}))}))}(se),se={})}),250);ie.push(l.a.subscribe("viewModelObject.propsUpdated",(function(e){for(var t in e)if(void 0===se[t])se[t]=e[t];else for(var n=0;n<e[t].length;n++){var l=e[t][n];-1===se[t].indexOf(l)&&se[t].push(l)}de()})));var ce=function(e){l.a.publish(t+".plTable.loadProps",{VMOs:e})};Y=new c(z);var ue=function(e){U.setDraggable(!e),W.updateEditStatus(e)};Q=function(e){if(U&&e.dataSource&&(e.dataSource.getAtomicData&&e.dataSource.getAtomicData().dpRef&&e.dataSource.getAtomicData().dpRef.current||e.dataSource.name===n.name)){var t="partialSave"===e.state||"starting"===e.state;"saved"===e.state?(i.a.forEach(n.cols,(function(e){S.default.setColumnFilterStale(e)})),a.a.util.isAutoSaveEnabled(z)||W.clearPropIsEditableCache(),a.a.util.setIsCellEditing(z,!1)):"canceling"===e.state&&(W.clearPropIsEditableCache(),a.a.util.setIsCellEditing(z,!1)),n.cacheCollapse=!0,a.a.util.setIsBulkEditing(z,t),b({type:"UPDATE_VALUES",isBulkEditing:z._tableInstance.isBulkEditing,dynamicRowHeightStatus:z._tableInstance.dynamicRowHeightStatus}),U.setSelectable(!t),(!1===a.a.util.isCellEditing(z)||a.a.util.isCellEditing(z)&&!a.a.util.isAutoSaveEnabled(z))&&ue(t),f.useTree&&!a.a.util.isExpandOrPaginationAllowedInEdit(z)&&function(e){X.setupTreeEditScroll(e)}(t),t||n.restoreInitialCacheCollapseState(),!0===z._tableInstance.dynamicRowHeightStatus&&(Se(),ve())}},ie.push(l.a.subscribe(n._eventTopicEditInProgress,(function(){if(!0!==P){const e={dataSource:n,state:n._editingState};Q(e)}}))),ie.push(l.a.subscribe(s._internal.eventTopicEditInProgress,(function(){const e={dataSource:s,state:s._editingState};Q(e)}))),ie.push(l.a.subscribe("plTable.editStateChange",(function(e){Q(e)}))),ie.push(l.a.subscribe("editHandlerStateChange",(function(e){Q(e)})));var fe=i.a.debounce((function(){var e=G.queryAllRowCellElementsFromTable();i.a.forEach(e,(function(e){if(e.vmo){var t=e.getElementsByClassName(a.a.Const.CLASS_SPLM_TABLE_ICON_CELL)[0];if(t||(t=e.getElementsByClassName(a.a.Const.CLASS_AW_TREE_COMMAND_CELL)[0]),t){var n=t.parentElement,l=n.columnDef,o=a.a.Cell.createElement(l,e.vmo,z,e);n.replaceChild(o,t)}}}))}),100);ie.push(l.a.subscribe(n.name+".resetScroll",(function(){Te()}))),!1===a.a.util.validateRowHeightGridOption(z._tableInstance.gridOptions)&&ie.push(l.a.subscribe("LayoutChangeEvent",(function(e){var t=$;if(t!==($=e.rowHeight)&&X.isInitialized()){X.setRowHeight($+1);var n=ae();void 0!==n&&X.setContainerHeight(n),X.initializeProperties(),z._tableInstance.dynamicRowHeightStatus&&Se(),X.updateRowAlignment();var l=G.getScrollCanvasElementFromTable(),o=l.scrollTop;l.scrollTop=o/t*$,X.handleScroll()}}))),!0!==(i.a.isString(P)?"true"===P:P)&&(ie.push(l.a.subscribe(n.name+".selectionChangeEvent",(function(){a.a.SelectionHelper.updateContentRowSelection(n.selectionModel,n.cols,G.getPinContentRowElementsFromTable(),G.getScrollContentRowElementsFromTable(),z)}))),ie.push(l.a.subscribe(n.name+".selectAll",(function(){a.a.SelectionHelper.updateContentRowSelection(n.selectionModel,n.cols,G.getPinContentRowElementsFromTable(),G.getScrollContentRowElementsFromTable(),z)}))),ie.push(l.a.subscribe(n.name+".selectNone",(function(){a.a.SelectionHelper.updateContentRowSelection(n.selectionModel,n.cols,G.getPinContentRowElementsFromTable(),G.getScrollContentRowElementsFromTable(),z)})))),ie.push(l.a.subscribe(t+".plTable.visibilityStateChanged",fe)),ie.push(l.a.subscribe(t+".plTable.resizeCheck",(function(){X.isInitialized()&&X.checkForResize()})));var me=function(e,l){if(t===e){if(a.a.util.isBulkEditing(z))return;for(var o=[],i=0;i<l.length;i++){var r=l[i].uid?l[i].uid:l[i],s=n.viewModelCollection.findViewModelObjectById(r);-1!==s&&o.push(s)}o.length>0&&X.scrollToRowIndex(o)}};ie.push(l.a.subscribe("plTable.scrollToRow",(function(e){me(e.gridId,e.rowUids)})));var pe=function(e){!0===e&&!1!==f.showDecorators?z.classList.add(a.a.Const.CLASS_AW_SHOW_DECORATORS):z.classList.remove(a.a.Const.CLASS_AW_SHOW_DECORATORS)},ge="decoratorToggle",be=p.default.getCtx(ge);pe(be),ie.push(l.a.subscribe("appCtx.register",(function(e){e.name===ge&&pe(e.value)}))),ie.push(l.a.subscribe("appCtx.update",(function(e){e.name===ge&&pe(e.value.decoratorToggle)}))),ie.push(l.a.subscribe("decoratorsUpdated",(function(e){e=void 0===e.length?[e]:e,U.updateColorIndicatorElements(e)}))),ie.push(l.a.subscribe(n.name+".expandTreeNode",(function(e){if(e.parentNode){var t=n.getViewModelCollection(),o=t.findViewModelObjectById(e.parentNode.id);if(-1!==o){var i=t.getViewModelObject(o);!0!==i.isExpanded&&(i.isExpanded=!0,E.toggleTreeNode?E.toggleTreeNode(i):l.a.publish(z.id+".plTable.toggleTreeNode",i))}}})));const u=function(e,t){var l=[],o=e.classList.contains(a.a.Const.CLASS_ROW)?e:a.a.util.closestElement(e,"."+a.a.Const.CLASS_ROW);if(o&&o.vmo){l.push(o.vmo);var i=o.vmo.uid;if(!t){var r=R.a.getSourceObjects(n,i).filter((function(e){return-1===l.indexOf(e)}));l=l.concat(r)}return l}return null};var he=!1,Ce=null;const v=(e,t)=>{he||(he=!0,Ce=t)},w=e=>!(!e||!e.types)&&("dragstart"===event.type&&[...e.types].some((e=>"text/plain"===e||"Text"===e)));let L={clearSelection:e=>{n.selectNone()},setSelection:e=>{v(null,e)},getTargetElementAndVmo:(e,t)=>{let n=null,l=null;return w(e.dataTransfer)||(l=O.closest(e.target,".ui-grid-row")||O.closest(e.target,".aw-widgets-droppable")),l&&(n=u(l,!t)),{targetElement:l,targetVMO:n}},highlightTarget:e=>{d.a.handleDragDropHighlightPLTable(e)}};const y=(e,t,n,l)=>{const o=e=>{let o={},i="dragstart"===e.type;t.getTargetElementAndVmo&&(o=t.getTargetElementAndVmo(e,i)),(0,n.dndHandler[e.type])(e,o,t,l)},i=t=>{let n=o.bind(null);e.addEventListener(t,n)},a=e=>{Object.keys(e).forEach((e=>{i(e.toLowerCase())}))};let r=x.a.getDragHandler(n);r&&a(r);let s=x.a.getDropHandler(n);s&&a(s)};z._tableInstance.subDefs=ie,e.appendChild(z),!1!==f.enableDragAndDrop?x.a.areDnDHandelersDefined(s)&&y(z,L,s,n):R.a.disableDragAndDrop(z)}let Ee=function(){var o=[];if(i.a.forEach(n.cols,(function(e){e.field&&!0!==e.hiddenFlag&&o.push(e.field)})),n&&n.action&&n.action.inputData){n.action.inputData.searchInput=n.action.inputData.searchInput||{};var r=n.action.inputData.searchInput;r.attributesToInflate?r.attributesToInflate=i.a.union(r.attributesToInflate,o):r.attributesToInflate=o}if(!0===f.transpose&&le(),X.isInitialized())X.resetRowHeightCache(),X.setLoadedVMObjects(ne()),0===G.getScrollCanvasElementFromTable().scrollTop?X.renderInitialRows():X.handleScroll();else{if(n.isFocusedLoad){var d=n.getSelectedObjects();1===d.length&&me(t,[d[0].uid])}X.initializeGrid({tableElem:z,directiveElem:e,scrollViewportElem:G.getScrollCanvasElementFromTable(),pinViewportElem:G.getPinCanvasElementFromTable(),rowSelector:"."+a.a.Const.CLASS_ROW,rowHeight:$+1,headerHeight:ee,dynamicRowHeightStatus:f.enableDynamicRowHeight,loadedVMObjects:ne(),updateVisibleCells:function(e){U.updateVisibleCells(e)},updateScrollColumnsInView:function(e,t){U.updateScrollColumnsInView(e,t)},onStartScroll:function(){a.a.util.isBulkEditing(z)},syncHeader:function(e,t){a.a.util.syncHeader(z,e,t)},renderRows:function(t,l){var o=ne().slice(t,l+1);if(0!==o.length){if(!0===f.useTree){let e=f.textBundle?f.textBundle:H;i.a.forEach(o,(function(t){t.isLeaf?t._twistieTitle="":t._twistieTitle=t.isExpanded?e.TwistieTooltipExpanded:e.TwistieTooltipCollapsed,a.a.util.isExpandAllowed(z)||(t._twistieTitle="")}))}var r=!1,s=G.getScrollContentElementFromTable(),d=G.getPinContentElementFromTable(),c=d.childElementCount>0?d.childNodes[0]:0,u=s.childElementCount>0?s.childNodes[0]:0;if(u&&u.getAttribute("data-indexNumber"))r=parseInt(u.getAttribute("data-indexNumber"))>t;var m=U.constructContentElement(o,t,$,!0),p=U.constructContentElement(o,t,$,!1);if(U.setAriaLabelledAndDescribedBy(e,G.getTableContainerElementFromTable()),U.setAriaRowCount(G.getTableContainerElementFromTable()),z._tableInstance.dynamicRowHeightStatus&&U.syncContentRowHeights(m,p),a.a.SelectionHelper.updateContentRowSelection(n.selectionModel,n.cols,m.childNodes,p.childNodes,z),r?(G.getPinContentElementFromTable().insertBefore(m,c),G.getScrollContentElementFromTable().insertBefore(p,u)):(G.getPinContentElementFromTable().appendChild(m),G.getScrollContentElementFromTable().appendChild(p)),z._tableInstance.focusTreeNodeExpandAfterRender){let e=z._tableInstance.focusTreeNodeExpandAfterRender,t=G.queryAllRowCellElementsFromTable(),n=i.a.filter(t,{vmo:e})[0];if(n){let e=n.getElementsByClassName(a.a.Const.CLASS_WIDGET_TREE_NODE_TOGGLE_CMD)[0];e&&e.focus()}}}},removeRows:function(e,t){k.resetHoverCommandElement(),U.removeContentElement(e,t),U.setAriaRowCount(G.getTableContainerElementFromTable())},afterGridRenderCallback:function(e,o){let i=G.getTableContainerElementFromTable();if(i&&i.hasAttribute("aria-activedescendant")){var r=i.getAttribute("aria-activedescendant");document.getElementById(r)||i.removeAttribute("aria-activedescendant")}var d=a.a.util.isBulkEditing(z);let c=!1;if(d&&ue(d),!0===f.useTree){if(!0===K)return;for(var u=!1,m=o.index;m>=e.index;m--){var p=n.viewModelCollection.loadedVMObjects[m];if(n.focusAction){if(p._focusRequested)return;if(p.isPlaceholder){if(u)return delete p.isPlaceholder,p._focusRequested=!0,void E.doFocusPlaceHolder(p)}else u=!0}}for(var g=e.index;g<=o.index;g++){var b=n.viewModelCollection.loadedVMObjects[g],h=!1;if(!0!==b.isLeaf&&!0!==b._expandRequested&&!0!==b.isExpanded&&a.a.util.performStateServiceAction("isNodeExpanded",s,t,b)&&(h=!0),!0===h)return b.isExpanded=!0,void(E.toggleTreeNode?E.toggleTreeNode(b):l.a.publish(z.id+".plTable.toggleTreeNode",b))}var C=oe(e.index,o.index);C.length>0&&(ce(C),c=!0)}a.a.util.isPaginationAllowed(z)&&E&&(re(e,o,E),E.loadMorePages({firstRenderedItem:e,lastRenderedItem:o})),!0===n.scrollToRow&&!0===X.isInitialRowIndexInView()&&(n.scrollToRow=!1)}}),X.renderInitialRows();var c=l.a.subscribe(t+".plTable.containerHeightUpdated",(function(e){we(e)}));ie.push(c)}},ve=function(){z&&z._tableInstance&&(z._tableInstance.showCheckBox=Z),a.a.util.cleanupComponents(z),Ee()},we=function(e){X.setContainerHeight(e),X.initializeProperties(),X.handleScrollDown()},Se=function(){n.viewModelCollection&&i.a.forEach(n.viewModelCollection.loadedVMObjects,(function(e){delete e.rowHeight}))},Te=function(){X&&X.isInitialized()&&X.resetInfiniteScroll()};return{getDynamicRowHeightStatus:function(){return z._tableInstance.dynamicRowHeightStatus},resetDynamicRowHeights:Se,updateDynamicRowHeight:function(e){z._tableInstance.dynamicRowHeightStatus=e,X.setDynamicRowHeight(z._tableInstance.dynamicRowHeightStatus),ve(),z._tableInstance.dynamicRowHeightStatus||Se()},maintainScrollPosition:function(){X.setScrollPositionToBeMaintained()},unsetScrollToRowIndex:function(){X&&X.isInitialized()&&X.resetInitialRowIndex()},relatedModified:function(){if(he){he=!1;var e=n.selectionModel;e&&(A.a.handleSelectionEvent([Ce],e,null,n),a.a.SelectionHelper.updateContentRowSelection(n.selectionModel,n.cols,G.getPinContentRowElementsFromTable(),G.getScrollContentRowElementsFromTable(),z))}},columnsResized:function(e){!0!==f.transpose&&r.columnSizeChanged(e.name,e.delta),z._tableInstance.dynamicRowHeightStatus&&(Se(),ve())},columnsRearranged:function(e){if(!0!==f.transpose){var t=e.originalPosition,l=null;i.a.forEach(n.cols,(function(t){e.name===t.name&&(l=t.index)})),i.a.forEach(n.cols,(function(e,n){!0===e.hiddenFlag&&n<=l&&(l+=1),!0===e.hiddenFlag&&n<=t&&(t+=1)})),n.cols&&"icon"!==n.cols[0].name&&(t+=1,l+=1),null!==t&&null!==l&&r.columnOrderChanged(e.name,t,l)}else le()},resetInfiniteScroll:Te,getTableElement:function(){return z},updateContentRowSelection:()=>{a.a.SelectionHelper.updateContentRowSelection(n.selectionModel,n.cols,G.getPinContentRowElementsFromTable(),G.getScrollContentRowElementsFromTable(),z)},updateContainerHeight:we,updateSortDirection:(e,t,n)=>{U.setHeaderCellSortDirection(e,t,n)},updatePinColumn:(e,t,n)=>{const l=t?e.index:n;U.pinToColumn(l),t||U.resetFreezeScroll(e.field),X.handlePinViewportScrollbarPadding()},hideColumn:e=>{let o;var a=n.cols;if(i.a.forEach(a,(function(t){if(t.field===e)return o=t,!1})),o){var s=o.index;let e=!0;if(i.a.forEach(a,(function(t){if(t.name!==o.name&&!0===t.visible&&"icon"!==t.name)return e=!1,!1})),e)L.default.getLocalizedText("UIMessages","hideColumnOnlyVisibleError").then((function(e){_.a.showError(e)}));else{if(r.isArrangeSupported()&&r.hideColumn){if(n.cols[s].propertyName!==o.propertyName)for(var d=0;d<a.length;d++)if(a[d].propertyName===o.propertyName){s=d;break}r.hideColumn(s)}if(U.updateColumnVisibility(o.field),o.filter&&o.filter.isFilterApplied){const e={gridId:t,column:o};l.a.publish("pltable.columnFilterApplied",e)}}}},resetColumns:function(){le()},updateEditState:Q,removeStaleFilters:function(e){S.default.removeStaleFilters(r,e||B)},setNodeExpansionInProgress:function(e){K=e},updateFilterIcons:function(e){e?U.updateFilterIcon(e):U.updateAllFilterIcons()},setFilterDisability:function(e){q.setFilterDisability(e)},loadMissingProps:function(){!function(){var e=X.getFirstRenderedItemIndex(),n=X.getLastRenderedItemIndex(),o=oe(e,n);o.length>0&&l.a.publish(t+".plTable.loadProps",{VMOs:o})}()},updateTreeCellIcon:function(e){const t=G.queryAllRowCellElementsFromTable();i.a.forEach(t,(function(t){if(t.vmo){if(!0===j.isIdOfObject(t.vmo,y.a.getEvaluatedId(e))){let n=t.querySelector(".".concat(a.a.Const.CLASS_WIDGET_TREE_NODE_TOGGLE_CMD));if(n){const t=function(e){return e.loadingStatus?{id:"miscInProcessIndicator",image:M.svgString}:e.isLeaf?{}:e.isExpanded?{id:"miscExpandedTree",image:N.svgString}:{id:"miscCollapsedTree",image:D.svgString}}(e);let l=n.querySelector(".".concat(a.a.Const.CLASS_ICON_BASE));l&&t&&t.image&&t.image.length>0&&(l=a.a.util.addAttributeToDOMElement(l,"iconId",t.id),l=a.a.util.addAttributeToDOMElement(l,"icon-id",t.id),n.title=e._twistieTitle,l.innerHTML=t.image)}}}}))},refresh:Ee,updateInstanceState:function(e){s=e,z._tableInstance.declViewModel=e}}},destroyTable:function(e,t,n){var o=t.querySelector(".".concat(a.a.Const.CLASS_TABLE)),r=o&&o._tableInstance||{},s=r.subDefs;i.a.forEach(s,(function(e){null!==e&&l.a.unsubscribe(e)}));for(var d=0;d<n.length;d++){var c=n[d].cellRenderers;if(c)for(var u=0;u<c.length;u++)i.a.isFunction(c[u].destroy)&&c[u].destroy()}a.a.util.cleanupComponents(t);var f=document.getElementById(e+"_menuContainer");null!==f&&f.parentElement.removeChild(f),r.renderer&&r.renderer.destroyGrid(),r.editor&&r.editor.destroy(),r.isDestroyed=!0,l.a.publish("tableDestroyed")}},F=n(134),B=n(128),j=n(507),k=n(31),z=n(55),G=n(47);const U=function(e,t,n,o,d){let c={},u={...o};const f=u.gridid,m=u.dataProviderInstance,p=u.columnProviderInstance;G.a.applyScope(n.data,u.gridOptions,null,n,null);let g=u.gridOptions,h=n.data;var C=[],E=null;let v=null;var w=[];const T={};p.setColumnFilters([]);var x=function(){f&&(m&&m.json&&m.json.firstPage&&delete m.json.firstPage,m.resetDataProvider())};if(f){var I=h.dataProviders[u.propertyProvider];p.sortCallback||(p.sortCallback=function(){x()}),g=g||{},g.enableArrangeMenu=u.enableArrangeMenu,g.showContextMenu=i.a.isNil(u.showContextMenu)?g.showContextMenu:u.showContextMenu,g.showDecorators=u.showDecorators,g.useTree=u.useTree,void 0===g.enableGridMenu&&g.enableArrangeMenu&&(g.enableGridMenu=!0),!0===g.enableHeaderIcon&&(g.headerHeight="XXLARGE");var R=i.a.debounce((function(e){if(!h.isDestroyed()){if(!m.topTreeNode.props){for(var t=m.topTreeNode.uid,l=!1,o=0;o<e.length;o++)if(e[o].uid===t){l=!0;break}l||e.push(m.topTreeNode)}if(0!==e.length){var r=[];i.a.forEach(m.cols,(function(e){e.isTreeNavigation||r.push(e)})),i.a.forEach(e,(function(e){e.isPropLoading=!0})),function(e){var t=F.a.createPropertyLoadInput([e]);I.getProperties(n,t).then((function(e){m.topNodeUid&&(i.a.forEach(e.updatedNodes,(function(e){e.uid===m.topNodeUid&&(void 0===m.topTreeNode.props&&(m.topTreeNode.props={}),i.a.assign(m.topTreeNode.props,e.props)),k.default.setEditState(e,!1),delete e.isPropLoading})),e.updatedNodes&&E.refresh()),e.columnConfig?e.columnConfig.columns.length!==m.cols.length&&p.buildDynamicColumns(e.columnConfig.columns,!0).then((()=>{E.resetColumns()})):E.refresh(),a.a.util.shouldRequestStartEditPropsLoaded(v)&&a.a.util.requestStartEdit(v)}))}({parentNode:null,childNodes:e,columnInfos:r})}}}),500,{maxWait:1e4,trailing:!0,leading:!1});c.completeInitialization=()=>{if(m.columnConfig)return m.initializationComplete="InProgress",p.buildDynamicColumns(m.columnConfig.columns,!0).then((()=>{var r=n.gridContextDispatcher;u.reusable&&(r=u.gridContextDispatcher),(E=P.createTableObject(e,f,m,t,p,h,u.contentFilter,g,u.containerheight,r,d,T,u.tableContext,u.reusable,u.showCheckBox)).showCheckBox=u.showCheckBox,E.resetColumns(),E.viewModelCollection=t,E.refresh(),o(),v=E.getTableElement(),m.initializationComplete=!0,u.containerHeight&&E.updateContainerHeight(u.containerHeight),C.push(l.c(f+".plTable.clientRefresh",(function(){i.a.defer((function(){E.showCheckBox=u.showCheckBox,v&&v._tableInstance&&(v._tableInstance.showCheckBox=u.showCheckBox),a.a.util.cleanupComponents(e),E.refresh()}))})))}))},c.updateTableColumns=e=>{e&&e.length>0&&p.buildDynamicColumns(e,!0).then((()=>{null!==E&&E.resetColumns()}))},c.updateContentRowSelection=()=>{E&&E.updateContentRowSelection()},c.selectTableColumn=e=>{e&&b.default.selectColumnCells(E.getTableElement(),e.field)},c.updateSortDirection=(e,t,n)=>{t>-1&&(E&&E.updateSortDirection(e,t,n),x())},c.updateDynamicRowHeight=e=>{E&&E.updateDynamicRowHeight(e)},c.updatePinColumn=(e,t,n)=>{e&&n>-1&&E&&E.updatePinColumn(e,t,n)},c.hideColumn=e=>{e&&E&&E.hideColumn(e)},c.columnFilterApplied=e=>{const t={isInternalTableEvent:!0,gridId:f,...e};l.b("pltable.columnFilterApplied",t);a.a.util.getTableMenuService(v).ensureAllTableMenusDismissed(),e.filters&&e.filters.length?S.default.setFilters(p,m,e.filters,e.column):e.column?S.default.removeFilter(e.column,p,m):S.default.removeAllFilters(m,p),m.isColumnFilterApplied=S.default.isColumnFilterApplied(m);const n=e.column?e.column.field:null;E.updateFilterIcons(n),x()},c.editStateUpdated=()=>{const e={dataSource:m,state:m._editingState};E.updateEditState(e)},c.updateEditState=async e=>{e&&e.tableContext&&(e.tableContext.startEdit&&!0===e.tableContext.startEdit.value?(await m.startEdit(e.dataCtxNode,e.dataCtxNode.data),e.tableContext.startEdit.update&&e.tableContext.startEdit.update(!1),e.tableContext.isBulkEditing&&e.tableContext.isBulkEditing.update&&e.tableContext.isBulkEditing.update(!0)):e.tableContext.cancelEdit&&!0===e.tableContext.cancelEdit.value?(await m.cancelEdits(e.dataCtxNode,e.dataCtxNode.data),e.tableContext.cancelEdit.update&&e.tableContext.cancelEdit.update(!1),e.tableContext.isBulkEditing&&e.tableContext.isBulkEditing.update&&e.tableContext.isBulkEditing.update(!1)):e.tableContext.saveEdit&&!0===e.tableContext.saveEdit.value&&(await m.saveEdits(e.dataCtxNode,e.dataCtxNode.data),e.tableContext.saveEdit.update&&e.tableContext.saveEdit.update(!1),e.tableContext.isBulkEditing&&e.tableContext.isBulkEditing.update&&e.tableContext.isBulkEditing.update(!1)))};const o=()=>{if(B.a.supportsResizeObserver()){const t=i.a.debounce((()=>{l.b(f+".plTable.resizeCheck")}),200,{maxWait:1e4,trailing:!0,leading:!1});B.a.observe(e,t)}};if(!0===g.useTree){C.push(l.c(f+".plTable.loadProps",(function(e){R(e.VMOs)}))),C.push(l.c("primaryWorkarea.reloadTop",(function(e){!(e&&e.retainAllStates)&&j.a.clearAllStates(h,f),m.json.firstPage&&delete m.json.firstPage,m.initialize(n)})));const e=function(e){if(!e.loadingStatus)if(e.loadingStatus=!0,E.updateTreeCellIcon(e),Object.assign(n.data.data,n.data.getData()),!0===e.isExpanded){E.setNodeExpansionInProgress(!0),e._expandRequested=!0;var t=m.viewModelCollection.loadedVMObjects.length;m.expandObject(n,e).then((function(n){E.setNodeExpansionInProgress(!1),t===n.loadedVMObjects.length&&(delete e.loadingStatus,E.refresh()),m.update(n.loadedVMObjects)})).finally((function(){E.setNodeExpansionInProgress(!1),E.loadMissingProps(),delete e.loadingStatus,delete e._expandRequested,E.updateTreeCellIcon(e),v._tableInstance.focusTreeNodeExpandAfterRender=e,a.a.util.shouldRequestStartEditTreeExpand(v,e,I)&&a.a.util.requestStartEdit(v)})),j.a.saveRowExpanded(h,f,e)}else m.collapseObject(n,e).then((function(e){m.update(e.loadedVMObjects),t===e.loadedVMObjects.length&&E.refresh()})).finally((function(){delete e.loadingStatus,E.updateTreeCellIcon(e),v._tableInstance.focusTreeNodeExpandAfterRender=e})),j.a.saveRowCollapsed(h,f,e)};C.push(l.c(f+".plTable.toggleTreeNode",e)),u.reusable&&(T.toggleTreeNode=e);const t=function(e){var t=m.viewModelCollection,o=t.findViewModelObjectById(y.a.getEvaluatedId(e)),a=null,r=t.getViewModelObject(o),d=r.levelNdx-1;if(-1===d)a=m.topTreeNode;else for(var c=o-1;c>=0;c--){var u=t.getViewModelObject(c);if(u.levelNdx===d){a=u;break}}if(null===a)return null;var f=F.a.createTreeLoadInput(a,0,null,e.id,m.treePageSize,!0,null),p={t_uid:m.topTreeNode.uid,o_uid:a.uid,c_uid:e.uid,uid:null},g={treeLoadInput:f,loadIDs:p};return e.loadingStatus=!0,Object.assign(n.data.data,n.data.getData()),m.someDataProviderSvc.executeLoadAction(m.nextAction,m.json,n,g).then((function(t){for(var n=y.a.getEvaluatedId(r),o=r.levelNdx,d=m.viewModelCollection,c=d.findViewModelObjectById(n),u=d.loadedVMObjects,p=[u[c]],g=c+1;g<u.length;g++){var b=u[g];if(b.levelNdx<=o)break;p.push(b)}for(var h=t.actionResultObj.responseObj.treeLoadResult,C=h.childNodes,v=0,w=0;w<C.length;w++)if(C[w].id===n){v=w;break}for(var S=0;S<C.length;S++)C[S].childNdx=S-v;0===v&&C[0].incompleteHead&&(r.incompleteHead=!0);var T=C.length-1;if(v===T&&C[T].incompleteTail&&(r.incompleteTail=!0),a.children=i.a.clone(C),a.children[v]=r,C.splice(v,1),0===C.length)return delete e.loadingStatus,delete e._focusRequested,void E.refresh();var x=v-1;s.a.insert(C,x,p),u.splice(c,p.length),s.a.insert(u,c-1,C),delete e.loadingStatus,delete e._focusRequested,m.update(u),l.b(m.name+".treeNodesLoaded",{treeLoadInput:f,treeLoadResult:h}),l.b(m.name+".modelObjectsUpdated",{viewModelObjects:u,noResults:!1})}))};T.doFocusPlaceHolder=t}else C.push(l.c(m.name+".modelObjectsUpdated",(function(e){e&&!e.arrangeColumnEvent&&c.columnsArranged(e)})));c.columnsArranged=e=>{e.arrangeType&&"saveColumnAndLoadAction"===e.arrangeType&&e.viewModelObjects&&(E.resetInfiniteScroll(),m.update(e.viewModelObjects,e.totalFound),E.refresh())},C.push(l.c(m.name+".resetState",(function(){j.a.clearAllStates(h,f),m.isFocusedLoad=!0}))),z.b("propertyRendererTemplates"),function(e,t,l){return t.initialize(l).then((function(l){return e.cols=e.cols?e.cols:l,e.json&&e.json.firstPage?null:e.initialize(n).then((function(){return e.cols&&0!==e.cols.length?null:e.columnConfig?t.buildDynamicColumns(e.columnConfig.columns,!0):Promise.reject(new Error("Column config not loaded"))}))}))}(m,p,n).then((()=>{var r=n.gridContextDispatcher;u.reusable&&(r=u.gridContextDispatcher),(E=P.createTableObject(e,f,m,t,p,h,u.contentFilter,g,u.containerheight,r,d,T,u.tableContext,u.reusable,u.showCheckBox)).showCheckBox=u.showCheckBox,v=E.getTableElement(),o(),E.viewModelCollection=t,E.refresh(),m.initializationComplete=!0,u.containerHeight&&E.updateContainerHeight(u.containerHeight),C.push(l.c(f+".plTable.clientRefresh",(function(){i.a.defer((function(){E.showCheckBox=u.showCheckBox,v&&v._tableInstance&&(v._tableInstance.showCheckBox=u.showCheckBox),a.a.util.cleanupComponents(e),E.refresh()}))})))}),(e=>{m.initializationComplete=!1,r.a.trace(e)}))}C.push(l.c("columnArrange",(function(e){(e.name===f||e.columnConfigId&&m.columnConfig&&e.columnConfigId===m.columnConfig.columnConfigId)&&(e.columns.length?E.removeStaleFilters(e.columns):S.default.removeAllFilters(m,p)),E.getDynamicRowHeightStatus()&&E.resetDynamicRowHeights()})));var L=l.c("cdm.relatedModified",(function(e){E.relatedModified()}));C.push(L),C.push(l.c(f+".plTable.reload",x)),C.push(l.c("pltable.columnFilterApplied",(function(e){if(f===e.gridId&&!0!==e.isInternalTableEvent){e.filters&&e.filters.length?S.default.setFilters(p,m,e.filters,e.column):e.column?S.default.removeFilter(e.column,p,m):S.default.removeAllFilters(m,p),m.isColumnFilterApplied=S.default.isColumnFilterApplied(m);const t=e.column?e.column.field:null;E.updateFilterIcons(t),x()}}))),c.updateColumnMenuData=function(e){i.a.forEach(m.cols,(function(t){if(e.columnName===t.field)return t.filter={...t.filter,...e},t.filter.columnMenuData=e,t.filter.showFilters&&(t.filter.showFilters.dbValue&&"false"!==t.filter.showFilters.dbValue?t.filter.showFilterFacets=!0:t.filter.showFilterFacets=!1),!1}))},C.push(l.c(f+".plTable.setFilterDisability",(function(e){f===e.gridId&&E.setFilterDisability(e.isFilterDisabled)}))),c.destroy=function(){var t=[];m.columnConfig&&m.columnConfig.columns&&(t=m.columnConfig.columns),i.a.forEach(C,(function(e){l.d(e)})),P.destroyTable(f,e,t)},c.updateVmCollection=e=>{E&&(E.viewModelCollection=e,a.a.util.shouldRequestStartEditPagination(v)&&a.a.util.requestStartEdit(v),E.refresh())},c.updateDeclGridObject=e=>{u=e},c.updateMenuContext=e=>{u.menuContext=e},c.updateState=e=>{h=e,E&&E.updateInstanceState(e)},c.refreshTable=()=>{E&&E.refresh()},c.updateGridOptionsForTableInstance=e=>{v&&v._tableInstance&&e&&void 0!==e.showCheckBox&&(v._tableInstance.showCheckBox=e.showCheckBox)},C.push(l.c(m.name+".selectionChangeEvent",(function(e){var t=e.selectionModel.getSelection();!0===m.isFocusedLoad&&t.length>0&&(m.isFocusedLoad=!1,m.scrollToRow=!0),(t.length>0&&t.length>=w.length&&!1===i.a.isEqual(w,t)||!0===m.scrollToRow)&&(m.scrollToRow=!0,l.b("plTable.scrollToRow",{gridId:f,rowUids:t})),w=t.slice()})));const A=function(e){r.a.trace("AW simple table: Loaded next tree page data"),!1,a.a.util.shouldRequestStartEditTreePagination(v,I)&&a.a.util.requestStartEdit(v),m.update(e.loadedVMObjects,e.totalFound)};T.loadMorePages=function(e){if(E.viewModelCollection){var t=e.lastRenderedItem.index;if(Object.assign(n.data.data,n.data.getData()),0!==t&&t===E.viewModelCollection.loadedVMObjects.length-1&&(m.nextAction||m.action)){var l=m.viewModelCollection.loadedVMObjects[t];if(m.hasMorePages()&&l.incompleteTail)return delete l.incompleteTail,e.lastRenderedItem.levelNdx>0?(!0,void m.getTreeNodePage(n,null,e.lastRenderedItem.uid,!0,null).then(A)):(!0,void m.pageDispatcher({type:"NEXT_PAGE"}));r.a.trace("AW simple table: Rendering of all rows below completed")}var o=e.firstRenderedItem.index;if(0===o&&m.previousAction){var i=m.viewModelCollection.loadedVMObjects[o];if(m.hasMorePagesUp()&&i.incompleteHead)return delete i.incompleteHead,E.maintainScrollPosition(),e.firstRenderedItem.levelNdx>0?(!0,void m.getTreeNodePage(n,null,e.firstRenderedItem.uid,!1,null).then(A)):(!0,void m.pageDispatcher({type:"PREVIOUS_PAGE"}));r.a.trace("AW simple table: Rendering of all rows above completed")}if(!0===g.useTree){var a=m.findIncompleteNodeInRange(o,t);if(null!==a&&a.levelNdx>0){var s=!0===a.incompleteTail;if(!0===s&&!m.nextAction&&!m.action)return;if(!1===s&&!m.previousAction)return;return delete a.incompleteHead,delete a.incompleteTail,!0,void m.getTreeNodePage(n,null,a.uid,s,null).then(A)}}}};T.unsetScrollToRowIndex=function(){E.unsetScrollToRowIndex()};T.columnsRearranged=function(e){E.columnsRearranged(e)};return T.columnsResized=function(e){E.columnsResized(e)},c};t.default={initializeTable:U}}}]);